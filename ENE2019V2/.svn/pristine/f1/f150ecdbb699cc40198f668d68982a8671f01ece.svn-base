<sql>	
    <view>DROP VIEW IF EXISTS V_COBERTURA;</view>
	<view>
	   CREATE VIEW V_COBERTURA AS	     
   SELECT ID, ORDEN, NOMBRE, VAL AS ESTADO,
			NULL AS USUCRE, NULL AS FECCRE, NULL AS USUREG, NULL AS FECREG, NULL AS FECENV FROM (
		    -- CARATULA
		    SELECT ID, 1 AS ORDEN, 'CARATULA' AS NOMBRE, CASE 
        WHEN   TIPOVIA is not null AND NOMBREVIA is NOT NULL AND PUERTA is NOT NULL AND RUC is NOT NULL AND RSOCIAL is NOT NULL
        AND FUNCIONAMIENTO is NOT NULL AND  P21 is NOT NULL AND P25 IS NOT NULL  AND P26_NOMB is NOT NULL AND P30 is not null      THEN 0
        ELSE 1 END AS VAL 
		    FROM T_05_DIG_CARATULA

		    UNION
		    -- CAPITULO 100
      	SELECT C.ID, 2 AS ORDEN, 'CAPITULO 100', CASE 
  			WHEN C.P25 IN (1,2) AND (C1P101A_1 IS NOT NULL AND C1P102 IS NOT NULL AND C1P105 IS NOT NULL AND C1P111_1 IS NOT NULL  AND C1P113 IS NOT NULL AND C1P115A IS NOT NULL  AND (IFNULL(C1P127_1,-1) +IFNULL(C1P127_2,-1) +IFNULL(C1P127_3,-1)+IFNULL(C1P127_4,-1)+IFNULL(C1P127_5,-1)+IFNULL(C1P127_6,-1)+IFNULL(C1P127_7,-1)+IFNULL(C1P127_8,-1)+IFNULL(C1P127_9,-1)+IFNULL(C1P127_11,-1)+IFNULL(C1P127_12,-1)  )>1  IS NOT NULL ) THEN 0 
  		  WHEN C.P25 IN (3,4) AND  (C1P111_1 IS NOT NULL  AND C1P113 IS NOT NULL AND C1P115A IS NOT NULL    AND (IFNULL(C1P127_1,-1) +IFNULL(C1P127_2,-1) +IFNULL(C1P127_3,-1)+IFNULL(C1P127_4,-1)+IFNULL(C1P127_5,-1)+IFNULL(C1P127_6,-1)+IFNULL(C1P127_7,-1)+IFNULL(C1P127_8,-1)+IFNULL(C1P127_9,-1)+IFNULL(C1P127_11,-1)+IFNULL(C1P127_12,-1)  )>1  IS NOT NULL ) THEN 0 
  			ELSE 1 END AS VAL 
	    FROM T_05_DIG_CARATULA C
	    LEFT JOIN T_05_DIG_MODULOI D ON C.ID = D.ID      
		   
		    UNION
		    -- CAPITULO 200
		    SELECT C.ID, 3 AS ORDEN, 'CAPITULO 200', CASE 
        WHEN  C2P202 IS NOT NULL  AND C2P208 IS NOT NULL  THEN 0    
        WHEN  C.P25 IN (1,2) AND  C2P217 IS NOT NULL  AND C2P219 IS NOT NULL  THEN 0    
        WHEN  C.P25 IN (3,4) AND C2P219 IS NOT NULL  THEN 0   
		    			ELSE 1 END AS VAL 
		    FROM T_05_DIG_CARATULA C
		    LEFT JOIN T_05_DIG_MODULOII D ON C.ID = D.ID      

		    
		    UNION
      -- CAPITULO 300
      SELECT C.ID, 4 AS ORDEN, 'CAPITULO 300', 
      CASE 
      WHEN IFNULL(C.P25,-1) IN (1,2) AND (IFNULL(C3P301A_T2,-1)  +IFNULL(C3P301A_11,-1)  )&#60; 2 AND C3P332 IS NOT NULL AND C3P333 IS NOT NULL THEN 0
      WHEN IFNULL(C.P25,-1) IN (1,2) AND (IFNULL(C3P301A_T2,-1) +IFNULL(C3P301A_11,-1)  )>1 
      AND IFNULL(C3P302A_8,-1)>1 AND C3P302A_A1 IS NOT NULL AND C3P302A_A2 IS NOT NULL AND C3P302A_A3 IS NOT NULL AND C3P302A_A4 IS NOT NULL
        AND C3P302A_A5 IS NOT NULL AND C3P302A_A6 IS NOT NULL AND C3P305 IS NOT NULL AND C3P307 IS NOT NULL AND C3P309 IS NOT NULL AND C3P318 IS NOT NULL 
        AND C3P330 IS NOT NULL AND C3P332 IS NOT NULL AND C3P333 IS NOT NULL 
        THEN 0
      WHEN IFNULL(C.P25,-1) IN (3,4) AND (IFNULL(C3P301A_T2,-1) +IFNULL(C3P301A_11,-1) )&#60; 2 THEN 0
      WHEN IFNULL(C.P25,-1) IN (3,4) AND (IFNULL(C3P301A_T2,-1) +IFNULL(C3P301A_11,-1) )>1 AND IFNULL(C3P302A_8,-1)>1 AND C3P302A_A1 IS NOT NULL AND C3P302A_A2 IS NOT NULL AND C3P302A_A3 IS NOT NULL AND C3P302A_A4 IS NOT NULL
        AND C3P302A_A5 IS NOT NULL AND C3P302A_A6 IS NOT NULL AND C3P305 IS NOT NULL AND C3P307 IS NOT NULL AND C3P309 IS NOT NULL AND C3P318 IS NOT NULL AND C3P320 IS NOT NULL  AND C3P330 IS NOT NULL THEN 0
      ELSE 1 END AS VAL 
      FROM T_05_DIG_CARATULA C
      LEFT JOIN T_05_DIG_MODULOIII01 D ON C.ID = D.ID
      LEFT JOIN T_05_DIG_MODULOIII02 E ON C.ID = E.ID      
      UNION
      
      -- CAPITULO 400 
      SELECT C.ID, 5 AS ORDEN, 'CAPITULO 400',               
      CASE
      WHEN IFNULL(C.P25,-1) IN (1,2) AND IFNULL(C4P401,-1) IN (3,4) AND C4P425A_1 IS NOT NULL AND C4P425A_2 IS NOT NULL AND C4P425A_3 IS NOT NULL AND C4P433 IS NOT NULL AND C4P435 IS NOT NULL AND C4P436A IS NOT NULL
          AND C4P438 IS NOT NULL AND C4P440A_1 IS NOT NULL AND C4P440A_2 IS NOT NULL AND C4P445 IS NOT NULL AND C4P449 IS NOT NULL AND C4P450A_1 IS NOT NULL AND C4P450A_2 IS NOT NULL AND C4P450A_3 IS NOT NULL AND C4P456 IS NOT NULL
          AND C4P464A IS NOT NULL AND C4P465 IS NOT NULL AND C4P466 IS NOT NULL AND C4P468A IS NOT NULL AND C4P469 IS NOT NULL AND C4P471 IS NOT NULL AND C4P473 IS NOT NULL AND C4P474 IS NOT NULL 
          AND C4P475A IS NOT NULL AND C4P476 IS NOT NULL AND C4P484 IS NOT NULL AND C4P484A IS NOT NULL AND C4P487 IS NOT NULL AND C4P489 IS NOT NULL  THEN 0  
      WHEN IFNULL(C.P25,-1) IN (1,2) AND IFNULL(C4P401,-1) IN (1,2) AND (IFNULL(C4P401A_1,0) + IFNULL(C4P401A_2,0) + IFNULL(C4P401A_3,0) + IFNULL(C4P401A_4,0) + IFNULL(C4P401A_5,0) + IFNULL(C4P401A_6,0) 
          + IFNULL(C4P401A_7,0) + IFNULL(C4P401A_8,0) + IFNULL(C4P401A_9,0) + IFNULL(C4P401A_10,0))>0 AND C4P404 IS NOT NULL AND C4P405 IS NOT NULL AND C4P408 IS NOT NULL AND C4P418 IS NOT NULL AND C4P425A_1 IS NOT NULL
          AND C4P425A_2 IS NOT NULL AND C4P425A_3 IS NOT NULL AND C4P433 IS NOT NULL AND C4P435 IS NOT NULL AND C4P436A IS NOT NULL AND C4P438 IS NOT NULL AND C4P440A_1 IS NOT NULL AND C4P440A_2 IS NOT NULL AND
          C4P445 IS NOT NULL AND C4P449 IS NOT NULL AND C4P450A_1 IS NOT NULL AND C4P450A_2 IS NOT NULL AND C4P450A_3 IS NOT NULL AND C4P456 IS NOT NULL AND C4P464A IS NOT NULL AND C4P465 IS NOT NULL AND C4P466 IS NOT NULL
          AND C4P468A IS NOT NULL AND C4P469 IS NOT NULL AND C4P471 IS NOT NULL AND C4P473 IS NOT NULL AND C4P474 IS NOT NULL AND C4P475A IS NOT NULL AND C4P476 IS NOT NULL AND C4P484 is not null 
          and C4P484A is not null and C4P487 is not null and C4P489 is not null  THEN 0    
      WHEN IFNULL(C.P25,-1) IN (3,4) AND IFNULL(C4P401,-1) IN (3,4) and C4P425A_1 is not null  and C4P425A_2 is not null and C4P425A_3 is not null and C4P433 is not null and C4P435 is not null and C4P436A is not null 
           and C4P438 is not null and C4P440A_1 is not null and C4P440A_2 is not null and C4P445 is not null and C4P449 is not null and C4P450A_1 is not null and C4P450A_2 is not null and C4P450A_3 is not null 
           and C4P456 is not null and C4P464A is not null and  C4P468A is not null and C4P469 is not null and C4P471 is not null and C4P473 is not null and C4P474 is not null and C4P475A is not null 
           and C4P476 is not null and C4P484 is not null and C4P484A is not null and C4P487 is not null and C4P489 is not null  THEN 0     
      WHEN IFNULL(C.P25,-1) IN (3,4) AND IFNULL(C4P401,-1) IN (1,2) AND (IFNULL(C4P401A_1,0) + IFNULL(C4P401A_2,0) + IFNULL(C4P401A_3,0) + IFNULL(C4P401A_4,0) + IFNULL(C4P401A_5,0) + IFNULL(C4P401A_6,0) 
          + IFNULL(C4P401A_7,0) + IFNULL(C4P401A_8,0) + IFNULL(C4P401A_9,0) + IFNULL(C4P401A_10,0))>0 and C4P404 is not null and C4P405 is not null and C4P408 is not null and C4P418 is not null and C4P425A_1 is not null 
          and C4P425A_2 is not null and C4P425A_3 is not null and C4P433 is not null and C4P435 is not null and C4P436A is not null and C4P438 is not null and C4P440A_1 is not null and C4P440A_2 is not null 
          and C4P445 is not null and C4P449 is not null and C4P450A_1 is not null and C4P450A_2 is not null and C4P450A_3 is not null and C4P456 is not null and C4P464A is not null 
          and C4P468A is not null and C4P469 is not null and C4P471 is not null and C4P473 is not null and C4P474 is not null and C4P475A is not null and C4P476 is not null and C4P484 is not null and C4P484A is not null 
          and C4P487 is not null and C4P489 is not null THEN 0
      ELSE 1 END AS VAL 
      FROM T_05_DIG_CARATULA C
      LEFT JOIN T_05_DIG_MODULOIV01 D ON C.ID = D.ID
      LEFT JOIN T_05_DIG_MODULOIV02 E ON C.ID = E.ID
      LEFT JOIN T_05_DIG_MODULOIV03 F ON C.ID = F.ID

		    
		    UNION
		    -- CAPITULO 500
		    SELECT C.ID, 6 AS ORDEN, 'CAPITULO 500', CASE 
        WHEN IFNULL(C5P501_1B,0)+IFNULL(C5P501_2B,0)+IFNULL(C5P501_3B,0)
               +IFNULL(C5P501_4B,0)+IFNULL(C5P501_5B,0)+IFNULL(C5P501_6B,0)+IFNULL(C5P501_7B,0)+IFNULL(C5P501_8B,0) > 0
               AND (C5P518 IS NOT NULL AND C5P521 IS NOT NULL ) THEN 0  
        WHEN IFNULL(C5P501_1B,0)+IFNULL(C5P501_2B,0)+IFNULL(C5P501_3B,0) > 0
               AND (C5P503 IS NOT NULL AND C5P518 IS NOT NULL ) THEN 0   
		    			ELSE 1 END AS VAL 
		    FROM T_05_DIG_CARATULA C
		    LEFT JOIN T_05_DIG_MODULOV01 D ON C.ID = D.ID
		    LEFT JOIN T_05_DIG_MODULOV02 E ON C.ID = E.ID        

		    UNION
		    -- CAPITULO 600
		    SELECT C.ID, 7 AS ORDEN, 'CAPITULO 600', CASE WHEN C6P601 IS NOT NULL AND C6P606 IS NOT NULL  AND C6P610 IS NOT NULL 
               AND C6P613 IS NOT NULL AND C6P615 IS NOT NULL AND C6P619 IS NOT NULL AND C6P624 IS NOT NULL THEN 0		    			
		    			ELSE 1 END AS VAL 
		    FROM T_05_DIG_CARATULA C
		    LEFT JOIN T_05_DIG_MODULOVI01 D ON C.ID = D.ID    
		    
		    UNION
		    -- CAPITULO 700
		     SELECT C.ID, 8 AS ORDEN, 'CAPITULO 700', CASE WHEN C7P701_1A IS NOT NULL 
                AND C7P701_2A IS NOT NULL AND C7P701_4A IS NOT NULL AND C7P701_5A IS NOT NULL 
                AND C7P701_6A IS NOT NULL AND C7P701_7A IS NOT NULL AND C7P701_8A IS NOT NULL 
              AND C7P702_1 IS NOT NULL AND C7P702_2 IS NOT NULL   AND C7P704 IS NOT NULL AND C7P707 IS NOT NULL  THEN 0
		    			ELSE 1 END AS VAL 
		    FROM T_05_DIG_CARATULA C
		    LEFT JOIN T_05_DIG_MODULOVII01 D ON C.ID = D.ID   
                  

		    UNION
		    -- CAPITULO 800
		    SELECT C.ID, 9 AS ORDEN, 'CAPITULO 800', CASE 
        WHEN C.P25 IN (3,4) AND FUNCIONAMIENTO > 2015
         AND (C8P801 IS NOT NULL AND  C8P804 IS NOT NULL AND C8P805 IS NOT NULL
         AND C8P806 IS NOT NULL AND (C8P807 IS NOT NULL  OR C8P807_1 IS NOT NULL ) AND (C8P808 IS NOT NULL OR C8P808_1 IS NOT NULL ) AND (C8P809 IS NOT NULL OR C8P809_1 IS NOT NULL ) 
         AND (C8P812 IS NOT NULL OR C8P812_1 IS NOT NULL ) AND C8P814 IS NOT NULL AND (C8P818 IS NOT NULL OR C8P818_1 IS NOT NULL )
         AND (C8P819 IS NOT NULL OR C8P819_1 IS NOT NULL )  AND (C8P822 IS NOT NULL OR C8P822_1 IS NOT NULL )
         AND  (C8P825 IS NOT NULL OR C8P825_1 IS NOT NULL OR C8P825_2 IS NOT NULL )  AND C8P827 IS NOT NULL AND C8P830 IS NOT NULL AND C8P834 IS NOT NULL 
         AND C8P839 IS NOT NULL AND C8P843 IS NOT NULL AND C8P845 IS NOT NULL)  THEN 0               


  			WHEN C.P25 IN (1,2) AND FUNCIONAMIENTO > 2015
         AND (C8P801 IS NOT NULL AND C8P804 IS NOT NULL AND C8P805 IS NOT NULL
         AND C8P806 IS NOT NULL AND (C8P809 IS NOT NULL OR C8P809_1 IS NOT NULL )  AND (C8P810 IS NOT NULL OR C8P810_1 IS NOT NULL)  AND C8P811 IS NOT NULL AND (C8P812 IS NOT NULL OR C8P812_1 IS NOT NULL)
         AND C8P814 IS NOT NULL AND   (C8P818 IS NOT NULL OR C8P818_1 IS NOT NULL ) AND  (C8P819 IS NOT NULL OR C8P819_1 IS NOT NULL)  AND (C8P822 IS NOT NULL OR C8P822_1 IS NOT NULL ) AND  (C8P825 IS NOT NULL OR C8P825_1 IS NOT NULL OR C8P825_2 IS NOT NULL )
         AND  (C8P826 IS NOT NULL OR C8P826_1 IS NOT NULL ) AND C8P827 IS NOT NULL AND C8P830 IS NOT NULL AND C8P834 IS NOT NULL AND C8P839 IS NOT NULL
         AND C8P843 IS NOT NULL AND C8P845 IS NOT NULL    )  THEN 0         
         
        
         WHEN C.P25 IN (3,4) AND FUNCIONAMIENTO &#60;= 2015
         AND (C8P801 IS NOT NULL AND C8P804 IS NOT NULL AND C8P805 IS NOT NULL
         AND C8P806 IS NOT NULL AND (C8P807 IS NOT NULL  OR C8P807_1 IS NOT NULL ) AND (C8P808 IS NOT NULL OR C8P808_1 IS NOT NULL ) AND (C8P809 IS NOT NULL OR C8P809_1 IS NOT NULL ) 
         AND (C8P812 IS NOT NULL OR C8P812_1 IS NOT NULL)  AND C8P814 IS NOT NULL AND (C8P818 IS NOT NULL OR C8P818_1 IS NOT NULL )
         AND (C8P819 IS NOT NULL OR C8P819_1 IS NOT NULL)  AND (C8P822 IS NOT NULL OR C8P822_1 IS NOT NULL) AND  (C8P825 IS NOT NULL OR C8P825_1 IS NOT NULL OR C8P825_2 IS NOT NULL )  AND C8P831 IS NOT NULL AND C8P834 IS NOT NULL 
         AND C8P839 IS NOT NULL AND C8P843 IS NOT NULL)  THEN 0                         


         WHEN C.P25 IN (1,2) AND FUNCIONAMIENTO &#60;= 2015 
         AND (C8P801 IS NOT NULL AND C8P804 IS NOT NULL AND C8P805 IS NOT NULL
         AND C8P806 IS NOT NULL AND (C8P809 IS NOT NULL OR C8P809_1 IS NOT NULL ) AND  (C8P810 IS NOT NULL OR C8P810_1 IS NOT NULL )   AND (C8P812 IS NOT NULL OR C8P812_1 IS NOT NULL )
         AND C8P814 IS NOT NULL AND (C8P818 IS NOT NULL OR C8P818_1 IS NOT NULL ) AND   (C8P819 IS NOT NULL OR C8P819_1 IS NOT NULL ) AND (C8P822 IS NOT NULL OR C8P822_1 IS NOT NULL )
         AND  (C8P825 IS NOT NULL OR C8P825_1 IS NOT NULL OR C8P825_2 IS NOT NULL )
         AND  (C8P826 IS NOT NULL OR C8P826_1 IS NOT NULL)  AND C8P831 IS NOT NULL  AND C8P834 IS NOT NULL AND C8P839 IS NOT NULL
         AND C8P843 IS NOT NULL)   THEN 0      
            
        ELSE 1 END AS VAL 
		    FROM T_05_DIG_CARATULA C
		    LEFT JOIN T_05_DIG_MODULOVIII D ON C.ID = D.ID
		    
		    UNION
	    -- CAPITULO 900
   		   SELECT C.ID, 10 AS ORDEN, 'CAPITULO 900', CASE     
	       WHEN C.P25 IN (1,2,3,4) AND MA.FLAG= 1 AND C.FUNCIONAMIENTO = 2017 AND (cast(substr(C.CIIU_CD,1,2) as INTEGER) IN (10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,41,42))
		   AND G.C9P909_ID IS NOT NULL  AND G.C9P909_2_1 IS NOT NULL AND J.C9P910_ID IS NOT NULL  AND J.C9P910_2_1 IS NOT NULL  AND W.C9P912_3 IS NOT NULL 
       AND   IFNULL(P.C9P914_COD,0)=5   AND IFNULL(O.C9P915_COD,0)=4 AND  IFNULL(K.C9P916_COD,0)=3 
		   THEN 0  
			   
	       WHEN C.P25 IN (1,2,3,4) AND MA.FLAG= 0 AND C.FUNCIONAMIENTO = 2017 AND (cast(substr(C.CIIU_CD,1,2) as INTEGER) IN (10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,41,42))
		   AND G.C9P909_ID IS NOT NULL AND G.C9P909_2_1 IS NOT NULL  AND J.C9P910_ID IS NOT NULL  AND J.C9P910_2_1 IS NOT NULL  AND W.C9P912_3 IS NOT NULL
       AND IFNULL(P.C9P914_COD,0)=5 AND IFNULL(O.C9P915_COD,0)=4 AND  IFNULL(K.C9P916_COD,0)=3 
		   THEN 0        
	       
		   WHEN C.P25 IN (1,2,3,4) AND MA.FLAG= 1 AND C.FUNCIONAMIENTO = 2017 AND (cast(substr(C.CIIU_CD,1,2) as INTEGER) NOT IN (10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,41,42))
		   AND G.C9P909_ID IS NOT NULL AND G.C9P909_2_1 IS NOT NULL  AND N.C9P911_ID IS NOT NULL  AND N.C9P911_2_1 IS NOT NULL  AND W.C9P912_3 IS NOT NULL 
       AND IFNULL(P.C9P914_COD,0)=5 AND IFNULL(O.C9P915_COD,0)=4 AND  IFNULL(K.C9P916_COD,0)=3 
		   THEN 0
		   
		   WHEN C.P25 IN (1,2,3,4) AND MA.FLAG= 0 AND C.FUNCIONAMIENTO = 2017 AND (cast(substr(C.CIIU_CD,1,2) as INTEGER) NOT IN (10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,41,42))
		   AND G.C9P909_ID IS NOT NULL AND G.C9P909_2_1 IS NOT NULL  AND N.C9P911_ID IS NOT NULL  AND N.C9P911_2_1 IS NOT NULL  AND W.C9P912_3 IS NOT NULL 
       AND IFNULL(P.C9P914_COD,0)=5 AND IFNULL(O.C9P915_COD,0)=4 AND  IFNULL(K.C9P916_COD,0)=3 
		   THEN 0     	   
		   
		   WHEN C.P25 IN (1,2,3,4) AND MA.FLAG= 1 AND C.FUNCIONAMIENTO  &#60;= 2016 AND (cast(substr(C.CIIU_CD,1,2) as INTEGER) IN (10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,41,42))
		   AND D.C9P901_ID IS NOT NULL AND E.C9P902_ID IS NOT NULL AND W.C9P904_7 IS NOT NULL AND W.C9P905_2 IS NOT NULL AND W.C9P905_9 IS NOT NULL AND W.C9P905_21 IS NOT NULL AND W.C9P905_26 IS NOT NULL 
		   AND W.C9P906_T1 IS NOT NULL AND W.C9P906_T2 IS NOT NULL AND W.C9P906_T3 IS NOT NULL AND W.C9P906_T4 IS NOT NULL AND W.C9P906_T5 IS NOT NULL AND W.C9P907_T1 IS NOT NULL AND W.C9P907_T2 IS NOT NULL AND W.C9P907_T3 IS NOT NULL AND W.C9P907_T4 IS NOT NULL AND W.C9P907_T5 IS NOT NULL
		   AND G.C9P909_ID IS NOT NULL AND G.C9P909_2_1 IS NOT NULL  AND J.C9P910_ID IS NOT NULL  AND J.C9P910_2_1 IS NOT NULL  AND W.C9P912_3 IS NOT NULL 
       AND IFNULL(P.C9P914_COD,0)=5 AND IFNULL(O.C9P915_COD,0)=4 AND  IFNULL(K.C9P916_COD,0)=3 
		   THEN 0     
		   
		   
		   WHEN C.P25 IN (1,2,3,4) AND MA.FLAG= 0 AND C.FUNCIONAMIENTO  &#60;= 2016 AND (cast(substr(C.CIIU_CD,1,2) as INTEGER) IN (10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,41,42))
		   AND G.C9P909_ID IS NOT NULL AND G.C9P909_2_1 IS NOT NULL  AND J.C9P910_ID IS NOT NULL  AND J.C9P910_2_1 IS NOT NULL  AND W.C9P912_3 IS NOT NULL 
       AND IFNULL(P.C9P914_COD,0)=5 AND IFNULL(O.C9P915_COD,0)=4 AND  IFNULL(K.C9P916_COD,0)=3 
		   THEN 0
		   
		   WHEN C.P25 IN (1,2,3,4) AND MA.FLAG= 1 AND C.FUNCIONAMIENTO  &#60;= 2016 AND (cast(substr(C.CIIU_CD,1,2) as INTEGER) NOT IN (10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,41,42))
		   AND D.C9P901_ID IS NOT NULL AND F.C9P903_ID IS NOT NULL AND W.C9P904_7 IS NOT NULL AND W.C9P905_2 IS NOT NULL AND W.C9P905_9 IS NOT NULL AND W.C9P905_21 IS NOT NULL AND W.C9P905_26 IS NOT NULL 
		   AND W.C9P906_T1 IS NOT NULL AND W.C9P906_T2 IS NOT NULL AND W.C9P906_T3 IS NOT NULL AND W.C9P906_T4 IS NOT NULL AND W.C9P906_T5 IS NOT NULL AND W.C9P907_T1 IS NOT NULL AND W.C9P907_T2 IS NOT NULL AND W.C9P907_T3 IS NOT NULL AND W.C9P907_T4 IS NOT NULL AND W.C9P907_T5 IS NOT NULL
		   AND G.C9P909_ID IS NOT NULL AND G.C9P909_2_1 IS NOT NULL  AND N.C9P911_ID IS NOT NULL  AND N.C9P911_2_1 IS NOT NULL  AND W.C9P912_3 IS NOT NULL  
       AND IFNULL(P.C9P914_COD,0)=5 AND IFNULL(O.C9P915_COD,0)=4 AND  IFNULL(K.C9P916_COD,0)=3 
		   THEN 0   
		   
		   
		   WHEN C.P25 IN (1,2,3,4) AND MA.FLAG= 0 AND C.FUNCIONAMIENTO  &#60;= 2016 AND (cast(substr(C.CIIU_CD,1,2) as INTEGER) NOT IN (10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,41,42))
		   AND G.C9P909_ID IS NOT NULL AND G.C9P909_2_1 IS NOT NULL AND N.C9P911_ID IS NOT NULL  AND N.C9P911_2_1 IS NOT NULL  AND W.C9P912_3 IS NOT NULL AND 
       IFNULL(P.C9P914_COD,0)=5 AND IFNULL(O.C9P915_COD,0)=4 AND  IFNULL(K.C9P916_COD,0)=3 
		   THEN 0
		   
			ELSE 1 END AS VAL 
			FROM T_05_DIG_CARATULA C    
			INNER JOIN T_MARCO MA ON C.ID=MA.ID 
			LEFT JOIN T_05_DIG_MODULOIX W ON C.ID = W.ID
			LEFT JOIN T_05_DIG_MODULOIX_DET01 D ON C.ID = D.ID
			LEFT JOIN T_05_DIG_MODULOIX_DET02 E ON C.ID = E.ID
			LEFT JOIN T_05_DIG_MODULOIX_DET03 F ON C.ID = F.ID    
			LEFT JOIN T_05_DIG_MODULOIX_DET04 H ON C.ID = H.ID    
			LEFT JOIN T_05_DIG_MODULOIX_DET06 G ON C.ID = G.ID          
			LEFT JOIN T_05_DIG_MODULOIX_DET07 J ON C.ID = J.ID
			LEFT JOIN T_05_DIG_MODULOIX_DET011 K ON C.ID = K.ID  AND C9P916_COD=3
			LEFT JOIN T_05_DIG_MODULOIX_DET05 M ON C.ID = M.ID  
			LEFT JOIN T_05_DIG_MODULOIX_DET08 N ON C.ID = N.ID 
			LEFT JOIN T_05_DIG_MODULOIX_DET010 O ON C.ID = O.ID   AND C9P915_COD=4
			LEFT JOIN T_05_DIG_MODULOIX_DET09 P ON C.ID = P.ID 	 AND C9P914_COD=5

	    )
	    ORDER BY ID, ORDEN     

	</view> 
</sql> 
